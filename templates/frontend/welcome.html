{% extends 'frontend/base.html' %}

{% block title %}QInvest ‚Äî Bem-vindo{% endblock %}

{% block header_subtitle %}Painel do Usu√°rio{% endblock %}
{% block step_indicator %}Painel{% endblock %}

{% block content %}
<div class="wrapper">
    <div class="card">
        <header>
            <h2>üéâ Bem-vindo ao QInvest</h2>
            <p>Seu painel de controle para empr√©stimos e investimentos</p>
        </header>
        <div class="body">
        {% if user.is_authenticated %}
            {% if user_context %}
            <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <h3>‚úÖ Usu√°rio Autenticado</h3>
                        <p><strong>Nome:</strong> {{ user_context.name }}</p>
                        <p><strong>Email:</strong> {{ user_context.email }}</p>
                        {% if user_type == 'borrower' %}
                            <p><strong>ID:</strong> {{ user_context.borrower_id }}</p>
                            <p><strong>Status KYC:</strong> 
                                {% if user_context.kyc_status == 'none' %}N√£o iniciado
                                {% elif user_context.kyc_status == 'pending' %}Em an√°lise
                                {% elif user_context.kyc_status == 'approved' %}Aprovado
                                {% elif user_context.kyc_status == 'rejected' %}Rejeitado
                                {% else %}{{ user_context.kyc_status|default:"N√£o iniciado" }}
                                {% endif %}
                            </p>
                        {% elif user_type == 'investor' %}
                            <p><strong>ID:</strong> {{ user_context.investor_id }}</p>
                            <p><strong>Status KYC:</strong> 
                                {% if user_context.kyc_status == 'none' %}N√£o iniciado
                                {% elif user_context.kyc_status == 'pending' %}Em an√°lise
                                {% elif user_context.kyc_status == 'approved' %}Aprovado
                                {% elif user_context.kyc_status == 'rejected' %}Rejeitado
                                {% else %}{{ user_context.kyc_status|default:"N√£o iniciado" }}
                                {% endif %}
                            </p>
                        {% endif %}
                    </div>
                    <a href="{% url 'frontend:logout' %}" class="btn btn-secondary" style="margin-left: 16px;">
                        <svg style="width: 16px; height: 16px; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16,17 21,12 16,7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                        Sair
                    </a>
                </div>
            </div>
            {% else %}
            <div style="background: #e1f5fe; color: #01579b; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <h3>üëã Bem-vindo, {{ user.first_name|default:user.username }}!</h3>
                        <p>Voc√™ est√° logado mas ainda n√£o tem um perfil completo. Complete seu cadastro para acessar todas as funcionalidades.</p>
                    </div>
                    <a href="{% url 'frontend:logout' %}" class="btn btn-secondary" style="margin-left: 16px;">
                        <svg style="width: 16px; height: 16px; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16,17 21,12 16,7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                        Sair
                    </a>
                </div>
            </div>
            {% endif %}
        {% else %}
            <div style="background: #fff3cd; color: #856404; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <h3>‚ö†Ô∏è Usu√°rio n√£o autenticado</h3>
                <p>Fa√ßa login para acessar todas as funcionalidades da API.</p>
                <a href="{% url 'frontend:login' %}" class="btn btn-primary">Fazer Login</a>
            </div>
        {% endif %}

        <div class="upload-item">
            <div class="left">
                <div class="title">üìä Simular Empr√©stimo</div>
                <div class="desc">Calcule as condi√ß√µes do seu empr√©stimo consignado</div>
            </div>
            <a href="{% url 'frontend:loan_simulation' %}" class="btn btn-outline">
                Simular ‚Üí
            </a>
        </div>

        <div class="upload-item">
            <div class="left">
                <div class="title">üìÑ Verificar Documentos</div>
                <div class="desc">Envie documentos para an√°lise</div>
            </div>
            <a href="{% url 'frontend:document_verification' %}" class="btn btn-outline">
                Enviar ‚Üí
            </a>
        </div>

        {% if is_investor or user_type == 'both' %}
        <div class="upload-item">
            <div class="left">
                <div class="title">üí∞ Ofertas Dispon√≠veis</div>
                <div class="desc">Veja ofertas de empr√©stimo personalizadas</div>
            </div>
            <a href="{% url 'frontend:marketplace' %}" class="btn btn-outline">
                Ver Ofertas ‚Üí
            </a>
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}